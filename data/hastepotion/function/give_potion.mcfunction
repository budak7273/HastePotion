# Gives the user the potion
# custom potion items store the amplifier as an 8bit signed int -> max is 127, but we need Haste 137 to instant mine deepslate
# the apply_true_haste_effect function (run by on_player_interval) takes care of giving the real effect to us
# it checks for bad luck level 42 (impossible to obtain normally) on players to give the real effect to 
# we can't just use the haste 93 as a marker, because drinking the potion again would then not re-apply the marker effect (since we already have haste 137 at that point)
give @s minecraft:potion{Potion:"minecraft:water",CustomPotionEffects:[{Id:3,Amplifier:93,Duration:9600,Ambient:1b},{Id:27,Amplifier:42,Duration:9600,Ambient:1b},{Id:4,Amplifier:1,Duration:19200,Ambient:1b},{Id:9,Duration:140,Ambient:1b},{Id:17,Duration:9600,Ambient:1b},{Id:24,Duration:1200,Ambient:1b}],display:{Name:'[{"text":"Potion of Caffeination","italic":false,"color":"yellow","bold":true}]',Lore:['[{"text":"Charges you up, but leaves you","italic":false,"color":"white"}]','[{"text":"drained after it expires.","italic":false,"color":"white"},{"text":"","italic":false,"color":"dark_purple"}]','[{"text":"","italic":false,"color":"dark_purple"}]','[{"text":"Upon Consumption:","italic":true,"color":"yellow"},{"text":"","italic":false,"color":"dark_purple"}]','[{"text":"Haste VIII (8:00)","italic":false,"color":"blue"},{"text":"","italic":false,"color":"dark_purple"}]','[{"text":"Glowing (1:00)","italic":false,"color":"blue"},{"text":"","italic":false,"color":"dark_purple"}]','[{"text":"Hunger (8:00)","italic":false,"color":"red"}]','[{"text":"Nausea (0:07)","italic":false,"color":"red"},{"text":"","italic":false,"color":"dark_purple"}]','[{"text":"After 8:00:","italic":true,"color":"yellow"},{"text":"","italic":false,"color":"dark_purple"}]','[{"text":"Mining Fatigue II (8:00)","italic":false,"color":"red"},{"text":"","italic":false,"color":"dark_purple"}]','[{"text":"","italic":false,"color":"dark_purple"}]']}, HideFlags: 32} 1

# Play a sound
execute as @s at @s run playsound minecraft:block.brewing_stand.brew voice @s ~ ~ ~ 1 0.75